# Voice Notes WASM - Flow Diagrams

## Application Data Flow

```
┌─────────────────┐     ┌───────────────┐     ┌─────────────────┐
│                 │     │               │     │                 │
│   Microphone    │──▶  │ Audio Capture │──▶  │ Audio Streaming │
│                 │     │               │     │                 │
└─────────────────┘     └───────────────┘     └─────────────────┘
                                                       │
                                                       ▼
┌─────────────────┐     ┌───────────────┐     ┌─────────────────┐
│                 │     │               │     │                 │
│  Notes Storage  │◀──  │ Transcription │◀──  │  Whisper WASM   │
│   (IndexedDB)   │     │    Engine     │     │    Processing   │
│                 │     │               │     │                 │
└─────────────────┘     └───────────────┘     └─────────────────┘
       │                        ▲
       │                        │
       ▼                        │
┌─────────────────┐     ┌───────────────┐     ┌─────────────────┐
│                 │     │               │     │                 │
│   Export to     │◀──  │ wscribe-editor│  ◀──│   UI Display    │
│ Various Formats │     │  Integration  │     │                 │
│                 │     │               │     │                 │
└─────────────────┘     └───────────────┘     └─────────────────┘
```

## User Interaction Sequence Flow

```
┌─────────┐     ┌────────────┐     ┌───────────┐     ┌────────────┐     ┌──────────┐
│         │     │            │     │           │     │            │     │          │
│  User   │     │  Recorder  │     │  Whisper  │     │  Editor    │     │ Storage  │
│         │     │            │     │           │     │            │     │          │
└────┬────┘     └─────┬──────┘     └─────┬─────┘     └──────┬─────┘     └─────┬────┘
     │                │                  │                  │                 │
     │  Start Record  │                  │                  │                 │
     │───────────────▶│                  │                  │                 │
     │                │                  │                  │                 │
     │                │Request Mic Access│                  │                 │
     │◀ ─ ─ ─ ─ ─ ─ ─ ┤                  │                  │                 │
     │                │                  │                  │                 │
     │ Allow Access   │                  │                  │                 │
     │───────────────▶│                  │                  │                 │
     │                │                  │                  │                 │
     │                │ Begin Recording  │                  │                 │
     │                │───────────────────────────────────▶│                 │
     │                │                  │                  │                 │
     │                │ Stream Audio Data│                  │                 │
     │                │─────────────────▶│                  │                 │
     │                │                  │                  │                 │
     │                │                  │ Real-time Text   │                 │
     │                │                  │─────────────────▶│                 │
     │                │                  │                  │                 │
     │                │                  │                  │ Display Text    │
     │                │                  │                  │────────────────▶│
     │                │                  │                  │                 │
     │ Stop Recording │                  │                  │                 │
     │───────────────▶│                  │                  │                 │
     │                │                  │                  │                 │
     │                │ Stop Audio Stream│                  │                 │
     │                │─────────────────▶│                  │                 │
     │                │                  │                  │                 │
     │                │                  │ Final Transcript │                 │
     │                │                  │─────────────────▶│                 │
     │                │                  │                  │                 │
     │                │                  │                  │ Unlock Editor   │
     │                │                  │                  │────────────────▶│
     │                │                  │                  │                 │
     │                │                  │                  │ Save Note      │
     │                │                  │                  │───────────────▶│
     │                │                  │                  │                │
     │                │                  │                  │                │
```

## Component Relationship Diagram

```
┌───────────────────────────────────────────────────────────────────┐
│                           Next.js App                             │
└───────────┬───────────────────┬───────────────────┬───────────────┘
            │                   │                   │
            ▼                   ▼                   ▼
┌───────────────────┐ ┌───────────────────┐ ┌───────────────────┐
│                   │ │                   │ │                   │
│    Components     │ │ WhisperContext    │ │   Database        │
│                   │ │                   │ │   Service         │
└─────┬───────┬─────┘ └─────────┬─────────┘ └─────────┬─────────┘
      │       │               │                     │
      │       │               │                     │
      ▼       ▼               ▼                     ▼
┌─────────┐ ┌─────────┐ ┌─────────────┐ ┌─────────────────────┐
│         │ │         │ │             │ │                     │
│ Recorder│ │ Editor  │ │ Whisper WASM│ │ IndexedDB (Dexie.js)│
│         │ │         │ │             │ │                     │
└─────────┘ └─────────┘ └─────────────┘ └─────────────────────┘
      │          │             │                   │
      │          │             │                   │
      └──────────┴─────────────┴───────────────────┘
                          │
                          ▼
                 ┌─────────────────┐
                 │                 │
                 │  Export Service │
                 │                 │
                 └─────────────────┘
```

## Entity Relationship Diagram (IndexedDB/Dexie Schema)

```
┌────────────────────────────┐
│           Note             │
├────────────────────────────┤
│ id: number (PK, auto)      │
│ title: string              │
│ transcript: string         │
│ audioBlob: Blob (optional) │
│ created: Date              │
│ updated: Date              │
│ tags: string[]             │
└────────────────────────────┘
          │
          │ 1:N
          ▼
┌────────────────────────────┐
│      TranscriptWord        │
├────────────────────────────┤
│ id: number (PK, auto)      │
│ noteId: number (FK)        │
│ text: string               │
│ startTime: number          │
│ endTime: number            │
│ confidence: number         │
└────────────────────────────┘
```

## State Transitions Diagram

```
┌───────────────┐      Start     ┌───────────────┐
│               │ ───────────────▶               │
│    Idle       │                │  Requesting   │
│               │ ◀─────────────── Mic Permission │
└───────────────┘      Deny      └───────────────┘
                                        │
                                        │ Allow
                                        ▼
┌───────────────┐      Stop     ┌───────────────┐
│               │ ◀─────────────┤               │
│  Editing      │               │   Recording   │
│               │               │               │
└───────────────┘               └───────────────┘
       │                               │
       │                               │
       │                               │
       │           ┌───────────────┐   │
       └──────────▶│               │◀──┘
                  │ Transcribing   │
                  │               │
                  └───────────────┘
                         │
                         │ Complete
                         ▼
                  ┌───────────────┐
                  │               │
                  │  Saving Note  │
                  │               │
                  └───────────────┘